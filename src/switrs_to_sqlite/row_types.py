from collections.abc import Sequence

import switrs_to_sqlite.make_map as mm
import switrs_to_sqlite.value_maps as vm
from switrs_to_sqlite.converters import (
    cellphone_use_to_bool,
    convert,
    county_city_location_to_county,
    negative,
    non_standard_str_to_bool,
    string_to_bool,
)
from switrs_to_sqlite.datatypes import DataType
from switrs_to_sqlite.schema import Column

# Type alias for date field definitions (kept as tuples - simpler structure)
# (header, db_name, DataType)
DateFieldDefinition = tuple[str, str, DataType]
DateParsingTable = tuple[DateFieldDefinition, ...]

DEFAULT_NULLS: set[str] = {"", "-"}

COLLISION_ROW: Sequence[Column] = (
    Column(
        header="CASE_ID",
        name="case_id",
        sql_type=DataType.TEXT,
        nulls=None,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="JURIS",
        name="jurisdiction",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="OFFICER_ID",
        name="officer_id",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="REPORTING_DISTRICT",
        name="reporting_district",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="CHP_SHIFT",
        name="chp_shift",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_SHIFT,
    ),
    Column(
        header="POPULATION",
        name="population",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.POPULATION,
    ),
    Column(
        header="CNTY_CITY_LOC",
        name="county_city_location",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="CNTY_CITY_LOC",
        name="county_location",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=county_city_location_to_county,
        mapping=vm.COUNTIES,
    ),
    Column(
        header="SPECIAL_COND",
        name="special_condition",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="BEAT_TYPE",
        name="beat_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.BEAT_TYPE,
    ),
    Column(
        header="CHP_BEAT_TYPE",
        name="chp_beat_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_BEAT_TYPE,
    ),
    Column(
        header="CITY_DIVISION_LAPD",
        name="city_division_lapd",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS | {"0"},
        converter=convert,
        mapping=None,
    ),
    Column(
        header="CHP_BEAT_CLASS",
        name="chp_beat_class",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_BEAT_CLASS,
    ),
    Column(
        header="BEAT_NUMBER",
        name="beat_number",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PRIMARY_RD",
        name="primary_road",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="SECONDARY_RD",
        name="secondary_road",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="DISTANCE",
        name="distance",
        sql_type=DataType.REAL,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="DIRECTION",
        name="direction",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.DIRECTION,
    ),
    Column(
        header="INTERSECTION",
        name="intersection",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="WEATHER_1",
        name="weather_1",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS | {"N", "Y"},
        converter=convert,
        mapping=vm.WEATHER,
    ),
    Column(
        header="WEATHER_2",
        name="weather_2",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS | {"N", "Y"},
        converter=convert,
        mapping=vm.WEATHER,
    ),
    Column(
        header="STATE_HWY_IND",
        name="state_highway_indicator",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="CALTRANS_COUNTY",
        name="caltrans_county",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CALTRANS_COUNTY,
    ),
    Column(
        header="CALTRANS_DISTRICT",
        name="caltrans_district",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="STATE_ROUTE",
        name="state_route",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="ROUTE_SUFFIX",
        name="route_suffix",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="POSTMILE_PREFIX",
        name="postmile_prefix",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="POSTMILE",
        name="postmile",
        sql_type=DataType.REAL,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="LOCATION_TYPE",
        name="location_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.LOCATION_TYPE,
    ),
    Column(
        header="RAMP_INTERSECTION",
        name="ramp_intersection",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.RAMP_INTERSECTION,
    ),
    Column(
        header="SIDE_OF_HWY",
        name="side_of_highway",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SIDE_OF_HIGHWAY,
    ),
    Column(
        header="TOW_AWAY",
        name="tow_away",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="COLLISION_SEVERITY",
        name="collision_severity",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.COLLISION_SEVERITY,
    ),
    Column(
        header="NUMBER_KILLED",
        name="killed_victims",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="NUMBER_INJURED",
        name="injured_victims",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_COUNT",
        name="party_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PRIMARY_COLL_FACTOR",
        name="primary_collision_factor",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.PRIMARY_COLLISION_FACTOR,
    ),
    Column(
        header="PCF_CODE_OF_VIOL",
        name="pcf_violation_code",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.PCF_VIOLATION_CODE,
    ),
    Column(
        header="PCF_VIOL_CATEGORY",
        name="pcf_violation_category",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.PCF_VIOLATION_CATEGORY,
    ),
    Column(
        header="PCF_VIOLATION",
        name="pcf_violation",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PCF_VIOL_SUBSECTION",
        name="pcf_violation_subsection",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="HIT_AND_RUN",
        name="hit_and_run",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.HIT_AND_RUN,
    ),
    Column(
        header="TYPE_OF_COLLISION",
        name="type_of_collision",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS | {"M"},
        converter=convert,
        mapping=vm.COLLISION_TYPE,
    ),
    Column(
        header="MVIW",
        name="motor_vehicle_involved_with",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.INVOLVED_WITH,
    ),
    Column(
        header="PED_ACTION",
        name="pedestrian_action",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.PEDESTRIAN_ACTION,
    ),
    Column(
        header="ROAD_SURFACE",
        name="road_surface",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.ROAD_SURFACE,
    ),
    Column(
        header="ROAD_COND_1",
        name="road_condition_1",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.ROAD_CONDITION,
    ),
    Column(
        header="ROAD_COND_2",
        name="road_condition_2",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.ROAD_CONDITION,
    ),
    Column(
        header="LIGHTING",
        name="lighting",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.LIGHTING,
    ),
    Column(
        header="CONTROL_DEVICE",
        name="control_device",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CONTROL_DEVICE,
    ),
    Column(
        header="CHP_ROAD_TYPE",
        name="chp_road_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PEDESTRIAN_ACCIDENT",
        name="pedestrian_collision",
        sql_type=DataType.INTEGER,
        nulls=None,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="BICYCLE_ACCIDENT",
        name="bicycle_collision",
        sql_type=DataType.INTEGER,
        nulls=None,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="MOTORCYCLE_ACCIDENT",
        name="motorcycle_collision",
        sql_type=DataType.INTEGER,
        nulls=None,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="TRUCK_ACCIDENT",
        name="truck_collision",
        sql_type=DataType.INTEGER,
        nulls=None,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="NOT_PRIVATE_PROPERTY",
        name="not_private_property",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="ALCOHOL_INVOLVED",
        name="alcohol_involved",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="STWD_VEHTYPE_AT_FAULT",
        name="statewide_vehicle_type_at_fault",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.STATEWIDE_VEHICLE_TYPE,
    ),
    Column(
        header="CHP_VEHTYPE_AT_FAULT",
        name="chp_vehicle_type_at_fault",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_VEHICLE_TYPE,
    ),
    Column(
        header="COUNT_SEVERE_INJ",
        name="severe_injury_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_VISIBLE_INJ",
        name="other_visible_injury_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_COMPLAINT_PAIN",
        name="complaint_of_pain_injury_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_PED_KILLED",
        name="pedestrian_killed_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_PED_INJURED",
        name="pedestrian_injured_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_BICYCLIST_KILLED",
        name="bicyclist_killed_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_BICYCLIST_INJURED",
        name="bicyclist_injured_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_MC_KILLED",
        name="motorcyclist_killed_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="COUNT_MC_INJURED",
        name="motorcyclist_injured_count",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PRIMARY_RAMP",
        name="primary_ramp",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.RAMP_TYPE,
    ),
    Column(
        header="SECONDARY_RAMP",
        name="secondary_ramp",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.RAMP_TYPE,
    ),
    Column(
        header="LATITUDE",
        name="latitude",
        sql_type=DataType.REAL,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="LONGITUDE",
        name="longitude",
        sql_type=DataType.REAL,
        nulls=DEFAULT_NULLS,
        converter=negative,
        mapping=None,
    ),
)

COLLISION_DATE_TABLE: DateParsingTable = (
    ("COLLISION_DATE", "collision_date", DataType.TEXT),
    ("COLLISION_TIME", "collision_time", DataType.TEXT),
    ("PROC_DATE", "process_date", DataType.TEXT),
)

PARTY_ROW: Sequence[Column] = (
    Column(
        header="CASE_ID",
        name="case_id",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_NUMBER",
        name="party_number",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_TYPE",
        name="party_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.PARTY_TYPE,
    ),
    Column(
        header="AT_FAULT",
        name="at_fault",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=string_to_bool,
        mapping=None,
    ),
    Column(
        header="PARTY_SEX",
        name="party_sex",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SEX,
    ),
    Column(
        header="PARTY_AGE",
        name="party_age",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS | {"998"},
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_SOBRIETY",
        name="party_sobriety",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SOBRIETY,
    ),
    Column(
        header="PARTY_DRUG_PHYSICAL",
        name="party_drug_physical",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.DRUG,
    ),
    Column(
        header="DIR_OF_TRAVEL",
        name="direction_of_travel",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.DIRECTION,
    ),
    Column(
        header="PARTY_SAFETY_EQUIP_1",
        name="party_safety_equipment_1",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SAFETY,
    ),
    Column(
        header="PARTY_SAFETY_EQUIP_2",
        name="party_safety_equipment_2",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SAFETY,
    ),
    Column(
        header="FINAN_RESPONS",
        name="financial_responsibility",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.FINANCIAL,
    ),
    Column(
        header="SP_INFO_1",
        name="hazardous_materials",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=non_standard_str_to_bool,
        mapping=None,
    ),
    Column(
        header="SP_INFO_2",
        name="cellphone_in_use",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=cellphone_use_to_bool,
        mapping=None,
    ),
    Column(
        header="SP_INFO_2",
        name="cellphone_use_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CELLPHONE_USE_TYPE,
    ),
    Column(
        header="SP_INFO_3",
        name="school_bus_related",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=non_standard_str_to_bool,
        mapping=None,
    ),
    Column(
        header="OAF_VIOLATION_CODE",
        name="oaf_violation_code",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.OAF_VIOLATION_CODE,
    ),
    Column(
        header="OAF_VIOL_CAT",
        name="oaf_violation_category",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS | {"00"},
        converter=convert,
        mapping=vm.OAF_VIOLATION_CATEGORY,
    ),
    Column(
        header="OAF_VIOL_SECTION",
        name="oaf_violation_section",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="OAF_VIOLATION_SUFFIX",
        name="oaf_violation_suffix",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="OAF_1",
        name="other_associate_factor_1",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.OTHER_FACTOR,
    ),
    Column(
        header="OAF_2",
        name="other_associate_factor_2",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.OTHER_FACTOR,
    ),
    Column(
        header="PARTY_NUMBER_KILLED",
        name="party_number_killed",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_NUMBER_INJURED",
        name="party_number_injured",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="MOVE_PRE_ACC",
        name="movement_preceding_collision",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.MOVEMENT_PRECEDING,
    ),
    Column(
        header="VEHICLE_YEAR",
        name="vehicle_year",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS | {"9999"},
        converter=convert,
        mapping=None,
    ),
    Column(
        header="VEHICLE_MAKE",
        name="vehicle_make",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=mm.MAKE_MAP,
    ),
    Column(
        header="STWD_VEHICLE_TYPE",
        name="statewide_vehicle_type",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.STATEWIDE_VEHICLE_TYPE,
    ),
    Column(
        header="CHP_VEH_TYPE_TOWING",
        name="chp_vehicle_type_towing",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_VEHICLE_TYPE,
    ),
    Column(
        header="CHP_VEH_TYPE_TOWED",
        name="chp_vehicle_type_towed",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.CHP_VEHICLE_TYPE,
    ),
    Column(
        header="RACE",
        name="party_race",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.RACE,
    ),
)

VICTIM_ROW: Sequence[Column] = (
    Column(
        header="CASE_ID",
        name="case_id",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="PARTY_NUMBER",
        name="party_number",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=None,
    ),
    Column(
        header="VICTIM_ROLE",
        name="victim_role",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.ROLE,
    ),
    Column(
        header="VICTIM_SEX",
        name="victim_sex",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SEX,
    ),
    Column(
        header="VICTIM_AGE",
        name="victim_age",
        sql_type=DataType.INTEGER,
        nulls=DEFAULT_NULLS | {"998"},
        converter=convert,
        mapping=None,
    ),
    Column(
        header="VICTIM_DEGREE_OF_INJURY",
        name="victim_degree_of_injury",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.DEGREE_OF_INJURY,
    ),
    Column(
        header="VICTIM_SEATING_POSITION",
        name="victim_seating_position",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SEATING_POSITION,
    ),
    Column(
        header="VICTIM_SAFETY_EQUIP_1",
        name="victim_safety_equipment_1",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SAFETY,
    ),
    Column(
        header="VICTIM_SAFETY_EQUIP_2",
        name="victim_safety_equipment_2",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.SAFETY,
    ),
    Column(
        header="VICTIM_EJECTED",
        name="victim_ejected",
        sql_type=DataType.TEXT,
        nulls=DEFAULT_NULLS,
        converter=convert,
        mapping=vm.EJECTED,
    ),
)
